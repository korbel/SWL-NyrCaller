##################
## Installation ##
##################

Extract zip file into your SWL folder, check if have the following directories:

- <SWL directory>\New York Raid Elite 10 Bot
- <SWL directory>\Data\Gui\Custom\Flash\Nyr10Caller

<SWL directory> is where the SecretWorldLegends.exe and SecretWorldLegendsDX11.exe files are located.

Restart the game.

You can use it locally or as a discord bot. If you want to use it as a discord bot there are additional things to set up before use. If you want to use it locally, skip to the USAGE section.

Setting it up as a Discord bot:

- To run it as a Discord bot, first you must install VBCable driver (it can be found in the "New York Raid Elite 10 Bot\VBCABLE_Driver_Pack43" directory), it will give the NYR bot the ability to connect its voice to a discord bot.
- Next you must set up a discord bot. If you already have a bot token and SERVER MEMBERS INTENT is enabled for the bot you can skip this the next step.
- To set a bot up, you must create a bot user first. To do that, visit the Discord Developer Portal (https://discordapp.com/developers/applications). After you created a bot user, make sure you enable SERVER MEMBERS INTENT in the bot settings.
- Enter the "Discord Audio Stream Bot" directory and start "run win32.bat" (you can try the win64 version first, but it might fail to start). You must have Java (JRE) installed.
- Go to the Settings tab of the Discord Audio Stream Bot application, and enter your bot token you received. Unmute audio input and select "CABLE Output (VB-Audio Virtual Cable)".
- On the Home tab start the bot. After it started, you can invite you bot to you service on the Maintenance tab. Make sure the bot has the correct permissions to enter and talk in the voice channels.
- Send the "help" command by direct message or by @mention to see how to use the bot. If you want the bot to follow you when you join a voice channel you can send a mention on your guild discord: @Bot_name follow-voice set @Your_name
- Further info and troubleshooting here: https://github.com/BinkanSalaryman/Discord-Audio-Stream-Bot

IMPORTANT!
Don't distribute your "Discord Audio Stream Bot" directory with the config.json as it contains the secret key to control your bot!
To change the secret key (bot token) go to https://discordapp.com/developers/applications/


###########
## Usage ##
###########

If you set the Discord got up, run "New York Raid Elite 10 Bot\start.bat", it will both start the discord bot (in win32 mode) and the caller app. On the Discord Audio Stream Bot window click the start button.
To run it locally without the discord bot, navigate to the "<SWL directory>\New York Raid Elite 10 Bot" directory and run the start_locally.bat executable instead.

IMPORTANT!
The bot must be running when you enter NYR E10. Upon entering NYR you should hear the bot saying "Welcome to New York raid E10!" indicating that everything is set up and working correctly.
If you forgot to start the bot then type /reloadui into the chat or press Ctrl + Shift + F1 (which is equivalent to /reloadui) before starting the fight. It will re-register all the raid participants and should say "Welcome to New York raid E10!" if it hasn't done so already.
The bot is listening to in-game events so upon the unfortunate event of the game crashing, it may lose track of the fight and say weird things for the rest of the fight. Beware.


###########################################
## Advanced settings and troubleshooting ##
###########################################

The bot uses the Microsoft Speech API and by default it tries to use Microsoft Zira's voice. If it cannot be found it uses the default one.

To test different voices and settings press Windows Key + R and run the following command:
rundll32.exe shell32.dll,Control_RunDLL C:\WINDOWS\system32\speech\speechux\sapi.cpl

You can also edit "start_locally.bat" and "start.bat" and change default settings. The following arguments can be set:
- voice: Name of the voice to be used. Run the following command in powershell to find other voices: (New-Object -ComObject SAPI.SPVoice).GetVoices() | % {$_.GetAttribute("Name")}
- speed: Speed of the speech. Must be an integer number between -10 and 10 (default is 0)
- log: Path of the game log file to parse. It should point to a valid ClientLog.txt
- redirectOutput: Redirects the audio output to the "CABLE Input (VB-Audio Virtual Cable)" channel. Used together with the discord bot.
- trace: Verbose output of in-game events
- rewind: Disable voice and re-parse the whole ClientLog.txt for debugging purposes

Example:
".\New York Raid Elite 10 Bot.exe" "redirectOutput" "voice=Microsoft David Desktop" "speed=8" "log=C:\Games\Secret World Legends\OldLogs\ClientLog20190412002700.txt" "trace" "rewind"
